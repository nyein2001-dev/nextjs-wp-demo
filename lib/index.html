<select id="contactType" name="contactType" class="form-control" required>
    <option value="">-- Please select --</option>
    <c:forEach var="option" items="${content.valueList.DropdownOption}">
        <option value="${option.value.OptionId}" 
            data-available="${option.value.IsAvailable}"
                data-include-radio="${option.value.IncludeRadioSection}"
                data-unavailable-text="${option.value.UnavailableText}"
                <c:if test="${option.value.OptionId eq param.contactType}">selected</c:if>>
            ${option.value.OptionName}
        </option>
    </c:forEach>
</select>

<c:forEach var="option" items="${content.valueList.DropdownOption}">
    <div id="${option.value.OptionId}" class="dropdown-view" style="display:none;">
        <p>${option.value.OptionName} View</p>
    </div>
</c:forEach>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const select = document.getElementById('contactType');
    const views = document.querySelectorAll('.dropdown-view');
    const unavailableText = document.getElementById('unavailable-text');

    function showSelectedView() {
        // Hide all views and the unavailable message
        views.forEach(view => view.style.display = 'none');
        unavailableText.style.display = 'none';
        unavailableText.textContent = '';

        const selectedOption = select.options[select.selectedIndex];
        const selectedValue = selectedOption.value;

        console.log('Selected value:', selectedValue);

        if (selectedValue) {
            const isAvailable = selectedOption.getAttribute('data-available') === 'true';
            const text = selectedOption.getAttribute('data-unavailable-text') || 'This option is unavailable.';

            console.log('Is available:', isAvailable);
            console.log('Unavailable text:', text);

            if (isAvailable) {
                const selectedView = document.getElementById(selectedValue);
                console.log('Selected view element:', selectedView);

                if (selectedView) {
                    selectedView.style.display = 'block';
                    console.log('Showing view for:', selectedValue);
                } else {
                    console.log('No view found for:', selectedValue);
                }
            } else {
                unavailableText.textContent = text;
                unavailableText.style.display = 'block';
                console.log('Showing unavailable text:', text);
            }
        } else {
            console.log('No value selected');
        }
    }

    // Initial load
    showSelectedView();

    // Change event
    select.addEventListener('change', showSelectedView);
});
</script>




<script>
document.addEventListener('DOMContentLoaded', function () {
    const select = document.getElementById('contactType');
    const views = document.querySelectorAll('.dropdown-view');
    const unavailableText = document.getElementById('unavailable-text');

    function resetViews() {
        views.forEach(view => view.style.display = 'none');
        unavailableText.style.display = 'none';
        unavailableText.innerHTML = '';
    }

    function handleRadioSelection(optionId) {
        const radios = document.querySelectorAll(`input[type="radio"][name="${optionId}"]`);
        radios.forEach(radio => {
            radio.addEventListener('change', function () {
                const viewId = `${optionId}_${this.value}`;
                const view = document.getElementById(viewId);
                resetViews();
                if (view) {
                    view.style.display = 'block';
                }
            });
        });
    }

    function showSelectedView() {
        resetViews();
        const selectedOption = select.options[select.selectedIndex];
        const selectedValue = selectedOption.value;

        if (!selectedValue) return;

        const isAvailable = selectedOption.getAttribute('data-available') === 'true';
        const includeRadio = selectedOption.getAttribute('data-include-radio') === 'true';
        const unavailableMsg = selectedOption.getAttribute('data-unavailable-text') || 'This option is unavailable.';

        if (!isAvailable) {
            unavailableText.innerHTML = unavailableMsg;
            unavailableText.style.display = 'block';
            return;
        }

        if (!includeRadio) {
            // Direct view
            const directView = document.getElementById(selectedValue);
            if (directView) directView.style.display = 'block';
        } else {
            // Show radio section
            const radioSection = document.getElementById(`${selectedValue}_radio`);
            if (radioSection) {
                radioSection.style.display = 'block';
                handleRadioSelection(selectedValue);
            }
        }
    }

    select.addEventListener('change', showSelectedView);
    showSelectedView(); // on initial load
});
</script>

