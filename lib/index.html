<select id="contactType" name="contactType" class="form-control" required>
    <option value="">-- Please select --</option>
    <c:forEach var="option" items="${content.valueList.DropdownOption}">
        <option value="${option.value.OptionId}" 
            data-available="${option.value.IsAvailable}"
                data-include-radio="${option.value.IncludeRadioSection}"
                data-unavailable-text="${option.value.UnavailableText}"
                <c:if test="${option.value.OptionId eq param.contactType}">selected</c:if>>
            ${option.value.OptionName}
        </option>
    </c:forEach>
</select>

<c:forEach var="option" items="${content.valueList.DropdownOption}">
    <div id="${option.value.OptionId}" class="dropdown-view" style="display:none;">
        <p>${option.value.OptionName} View</p>
    </div>
</c:forEach>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const select = document.getElementById('contactType');
    const views = document.querySelectorAll('.dropdown-view');
    const unavailableText = document.getElementById('unavailable-text');

    function showSelectedView() {
        const selectedOption = select.options[select.selectedIndex];
        const selectedValue = selectedOption.value;

        // Hide all views and the unavailable text first
        views.forEach(view => view.style.display = 'none');
        unavailableText.style.display = 'none';
        unavailableText.textContent = '';

        if (selectedValue) {
            const isAvailable = selectedOption.getAttribute('data-available') === 'true';
            const text = selectedOption.getAttribute('data-unavailable-text') || 'This option is unavailable.';

            if (isAvailable) {
                const selectedView = document.getElementById(selectedValue);
                if (selectedView) {
                    selectedView.style.display = 'block';
                }
            } else {
                unavailableText.textContent = text;
                unavailableText.style.display = 'block';
            }
        }
    }

    // Initial run
    showSelectedView();

    // On selection change
    select.addEventListener('change', showSelectedView);
});
</script>
