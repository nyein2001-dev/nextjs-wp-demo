<%
    // Get all query parameters
    String transactionParam = request.getParameter("transaction");
    String wishNoParam = request.getParameter("wishNo");
    String availableNoParam = request.getParameter("availableNo");
    String emailParam = request.getParameter("email");

    // Define your logic
    boolean isPolicyLinking = "policy_linking".equalsIgnoreCase(transactionParam);

    // ADD THIS LINE - Make it available to EL
    pageContext.setAttribute("isPolicyLinking", isPolicyLinking);
%>

<div class="radio-checkbox_wrapper field-item">
    <div class="radio-checkbox">
        <label class="radio-checkbox__label" for="yes" style="display: flex">
            <input class="radio-checkbox__input" 
                   type="radio" 
                   name="policyRadios" 
                   id="yes" 
                   value="Yes"
                   <%= isPolicyLinking ? "checked" : "" %> />
            <span></span>${content.value.Section1.value.RadioOptionsYesLabel}
        </label>

        <label class="radio-checkbox__label" for="no" style="display: flex">
            <input class="radio-checkbox__input" 
                   type="radio" 
                   name="policyRadios" 
                   id="no" 
                   value="No"
                   <%= !isPolicyLinking ? "checked" : "" %> />
            <span></span>${content.value.Section1.value.RadioOptionsNoLabel}
        </label>
    </div>
</div>


<p>Wish No: <%= wishNoParam %></p>
<p>Available No: <%= availableNoParam %></p>
<p>Email: <%= emailParam %></p>

    https://www.prulifeuk.com.ph/en/contact-us-form-test?wishNo=12345678&availableNo=12345678&email=example@gmail.com&transaction=policy_linking

<input type="hidden" name="wishNo" value="<%= wishNoParam %>" />
<input type="hidden" name="availableNo" value="<%= availableNoParam %>" />
<input type="hidden" name="email" value="<%= emailParam %>" />


<select 
    class="w-100"
    data-select-dropdown
    data-style
    data-live-search="true"
    aria-expanded="true"
    name="select-service"
    id="select-service"
    <%= isPolicyLinking ? "disabled" : "" %>  <!-- disable dropdown if policy_linking -->
>


<option value="${item.value.OptionName}"
    data-option-id="${item.value.OptionId}"
    data-available="${item.value.IsAvailable}"
    data-include-radio="${item.value.IncludeRadioSection}"
    data-unavailable-text="${item.value.UnavailableText}"
    <c:if test="${isPolicyLinking and (item.value.OptionName eq 'PRUServices Policy Linking')}">selected="selected"</c:if>
>

    <option value="${item.value.OptionName}"
    data-option-id="${item.value.OptionId}"
    data-available="${item.value.IsAvailable}"
    data-include-radio="${item.value.IncludeRadioSection}"
    data-unavailable-text="${item.value.UnavailableText}"
    ${isPolicyLinking and (item.value.OptionName eq 'PRUServices Policy Linking') ? 'selected' : ''}
>



<% if (isPolicyLinking) { %>
    <input type="hidden" name="select-service" value="Policy Linking" />
<% } %>


    <c:forEach var="item" items="${content.value.Dropdown.valueList.DropdownOption}">
    <option value="${item.value.OptionName}"
        data-option-id="${item.value.OptionId}"
        data-available="${item.value.IsAvailable}"
        data-include-radio="${item.value.IncludeRadioSection}"
        data-unavailable-text="${item.value.UnavailableText}"
        <%
            if ("Policy Linking".equalsIgnoreCase((String) pageContext.getAttribute("item.value.OptionName"))
                && Boolean.TRUE.equals(pageContext.getAttribute("isPolicyLinking"))) {
        %>selected="selected"<%
            }
        %>>
        ${item.value.OptionName}
    </option>
</c:forEach>







