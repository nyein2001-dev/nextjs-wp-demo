<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PruBSN Takaful Enquiry Form</title>
</head>
<body>

    <!-- Main form container -->
    <div>
        <h1>PruBSN Takaful Enquiry</h1>
        
        <!-- The form itself -->
        <form action="https://webto.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8&orgId=00DHr0000077xXi" method="POST">

            <!-- Hidden Salesforce fields -->
            <input type="hidden" name="oid" value="00DHr0000077xXi">
			<input type="hidden" name="retURL" value="https://www.prubsn.com.my/">
			
			<select  id="lead_source" name="lead_source" style="display:none;">
				<option value="">--None--</option>
				<option value="Website" selected>Website</option>
			</select><br>
			
			<!--<input type="hidden" name="debug" value=1>
			<input type="hidden" name="debugEmail"value="tham@lavaprotocols.com">-->
			
			<!-- Hidden fields for UTM & Campaign tracking -->
			<input type="hidden" id="00Ncx000002dTe0" name="00Ncx000002dTe0" maxlength="255" size="20" /> <!-- utm_source -->
			<input type="hidden" id="00Ncx000002dTdz" name="00Ncx000002dTdz" maxlength="255" size="20" /> <!-- utm_medium -->
			<input type="hidden" id="00Ncx000002dTdx" name="00Ncx000002dTdx" maxlength="255" size="20" /> <!-- campaign -->
			<input type="hidden" id="00Ncx000002dTe1" name="00Ncx000002dTe1" maxlength="255" size="20" /> <!-- utm_term -->
			<input type="hidden" id="00Ncx000002dTdy" name="00Ncx000002dTdy" maxlength="255" size="20" /> <!-- utm_content -->

			<!--<select id="Campaign_ID" name="Campaign_ID" style="display:none;">
			  <option value="">--None--</option>
			  <option value="701WJ00000Lo5el">MgM Campaign Sep'25</option>
			</select>-->
			
            <!-- Existing Customer Question (radio buttons) -->
            <div>
                <label>Are you an existing PruBSN Takaful customer?</label>
                <div>
                    <div>
                        <input type="radio" id="isCustomerYes" name="existingCustomerRadio" value="Y" required>
                        <label for="isCustomerYes">Y</label>
                    </div>
                    <div>
                        <input type="radio" id="isCustomerNo" name="existingCustomerRadio" value="N" required>
                        <label for="isCustomerNo">N</label>
                    </div>
                </div>
            </div>

			<!-- Hidden Salesforce Checkbox Field -->
			<input type="hidden" id="sfExistingCustomer" name="00Ncx000002dTdr" value="">

            <!-- Full Name field -->
            <div>
                <label for="last_name">Full Name:</label>
                <input id="last_name" maxlength="80" name="last_name" type="text" placeholder="John Doe" required>
            </div>

            <!-- Phone Number field (Malaysian only) -->
            <div>
                <label for="phone">Phone Number (Malaysia):</label>
                <input id="phone" maxlength="40" name="phone" type="tel" placeholder="e.g. 0123456789" required>
            </div>

            <!-- Email Address field -->
            <div>
                <label for="email">Email Address:</label>
                <input id="email" maxlength="80" name="email" type="email" placeholder="johndoe@example.com" required>
            </div>

            <!-- IC Number field with placeholder -->
            <div>
                <label for="icNumber">IC Number:</label>
                <input id="icNumber" maxlength="12" name="00Ncx000002giwL" type="text" placeholder="e.g. 990909109191 (no hyphens)" required>
            </div>
			
			<!-- STATE PICKLIST (Salesforce field 00Ncx000002dTdv) -->
			<div id="locationField">
				<label for="00Ncx000002dTdv">State:</label>
				<select id="00Ncx000002dTdv" name="00Ncx000002dTdv" title="State" required onchange="loadCities()">
					<option value="" disabled selected>Please select a state</option>
					<option value="KL & Selangor">KL & Selangor</option>
					<option value="Perak">Perak</option>
					<option value="Penang">Penang</option>
					<option value="Melaka">Melaka</option>
					<option value="Negeri Sembilan">Negeri Sembilan</option>
					<option value="Johor">Johor</option>
					<option value="Kedah">Kedah</option>
					<option value="Perlis">Perlis</option>
					<option value="Pahang">Pahang</option>
					<option value="Kelantan">Kelantan</option>
					<option value="Terengganu">Terengganu</option>
					<option value="Sabah">Sabah</option>
					<option value="Sarawak">Sarawak</option>
				</select>
			</div>
			
			<!-- CITY PICKLIST (Salesforce field 00Ncx000002dTe7) -->
			<div id="locationField">
				<label for="location">City:</label>
				<select id="location" name="00Ncx000002dTe7" title="City" required>
					<option value="" disabled selected>Please select a city</option>
				</select>
			</div>

            <!-- Conditional field 7: Type of Enquiry (shown if 'Y' is selected) -->
            <div id="enquiryField" style="display: none;">
                <label for="00Ncx000002dTdw">What is your type of enquiry?</label>
                <select id="enquiry" name="00Ncx000002dTdw" title="Type of Enquiry" required>
                    <option value="" disabled selected>Please select an enquiry type</option>
                    <option value="New plan / certificate related">New plan / certificate related</option>
                    <option value="Claims related / others">Claims related / others</option>
                </select>
            </div>

            <!-- Consent Checkbox -->
            <div>
                <input type="checkbox" id="consent" name="00Ncx000002dTe2" value="1" required>
                <label for="consent">
                    I agree to the terms and conditions and consent to my data being processed.
                </label>
            </div>

            <!-- Submit button -->
            <input type="submit" name="submit">

        </form>
    </div>

    <script>
        // 1. Get the elements by their ID
		const isCustomerYes = document.getElementById('isCustomerYes');
		const isCustomerNo = document.getElementById('isCustomerNo');
		const enquiryField = document.getElementById('enquiryField');
		const sfField = document.getElementById('sfExistingCustomer');
		const enquirySelect = document.getElementById('enquiry');

		// 2. The toggle function
		function updateConditionalFields() {

			if (isCustomerYes.checked) {

				// Show enquiry
				enquiryField.style.display = 'block';
				enquirySelect.required = true;

				// Set Salesforce checkbox TRUE
				sfField.value = "1";

			} else if (isCustomerNo.checked) {

				// Hide enquiry
				enquiryField.style.display = 'none';
				enquirySelect.required = false;
				enquirySelect.value = "";

				// Set Salesforce checkbox FALSE
				sfField.value = "";

			}
		}

		// 3. Re-attach listeners to the new IDs
		isCustomerYes.addEventListener('change', updateConditionalFields);
		isCustomerNo.addEventListener('change', updateConditionalFields);

		// 4. Run once on load
		updateConditionalFields();
        
        // Add a simple form submission listener for demonstration
        document.getElementById('leadForm').addEventListener('submit', function(event) {
            // This alert is here for demonstration purposes. In a real-world scenario, you would
            // remove this and allow the form to submit to Salesforce.
            alert('Form submitted successfully!');
        });
    </script>
	
	<script>
	  function getQueryParam(name) {
		let params = new URLSearchParams(window.location.search);
		return params.get(name) || "";
	  }

	  document.addEventListener("DOMContentLoaded", function () {
		// ✅ UTM mapping
		document.getElementById("00Ncx000002dTe0").value = getQueryParam("utm_source");   // Source
		document.getElementById("00Ncx000002dTdz").value = getQueryParam("utm_medium");   // Medium
		document.getElementById("00Ncx000002dTe1").value = getQueryParam("utm_term");     // Term
		document.getElementById("00Ncx000002dTdy").value = getQueryParam("utm_content");  // Content
		document.getElementById("00Ncx000002dTdx").value = getQueryParam("utm_campaign"); // Campaign

		// ✅ Campaign_ID dropdown selection
		/*let campaignParam = getQueryParam("campaign");  // reads ?campaign=...
		let selectField = document.getElementById("Campaign_ID");

		if (campaignParam && selectField) {
		  let optionToSelect = Array.from(selectField.options).find(
			opt => opt.value === campaignParam
		  );
		  if (optionToSelect) {
			optionToSelect.selected = true;
		  }
		}*/
	  });
	</script>
	
	<script>
		// State → City Mapping
		const cityData = {
			"KL & Selangor": ["Banting", "Kajang", "Klang Valley", "Kuala Selangor"],
			"Perak": ["Ipoh", "Sitiawan", "Taiping", "Teluk Intan"],
			"Penang": ["Penang Island", "Seberang Perai"],
			"Melaka": ["Melaka"],
			"Negeri Sembilan": ["Bahau", "Seremban"],
			"Johor": ["Batu Pahat", "Johor Bahru", "Kluang", "Kota Tinggi", "Mersing", "Muar", "Segamat"],
			"Kedah": ["Alor Setar", "Sungai Petani"],
			"Perlis": ["Kangar"],
			"Pahang": ["Bentong", "Kuantan", "Mentakab", "Raub"],
			"Kelantan": ["Kota Bahru"],
			"Terengganu": ["Kemaman", "Kuala Terengganu"],
			"Sabah": ["Kota Kinabalu", "Lahad Datu", "Labuan", "Sandakan", "Tawau"],
			"Sarawak": ["Bintulu", "Kuching", "Miri", "Sibu"]
		};

		// Function to load cities based on selected state
		function loadCities() {
			const stateValue = document.getElementById("00Ncx000002dTdv").value;
			const citySelect = document.getElementById("location");

			citySelect.innerHTML = "<option value='' disabled selected>Please select a city</option>";

			if (cityData[stateValue]) {
				cityData[stateValue].forEach(function(city) {
					citySelect.innerHTML += `<option value="${city}">${city}</option>`;
				});
			}
		}
	</script>



</body>
</html>
